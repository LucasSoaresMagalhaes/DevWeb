var db_contato = {
    data: [
        {

            cidade: "Belo Horizonte",
            id: "https://randomuser.me/api/portraits/women/49.jpg",
            nome: "Scarlett Johansson",
            numero_pessoal: "2895",
            dataNasc: "08/05/2000",
            email: "viuvanegra35@gmail.com",
            bio: "Boa noite você está no vermelho",
            categoria: "Análise e desenvolvimento de sistemas",
            nota: "92",
            telefone: "484-322-5952",
            senha: "senha",
            logado: "0",
            cor: "1",
            carteirinha:"/img/Portrait_Placeholder.png",
            senhacanvas: "1234",
            admin:"1"

        },
        {

            cidade: "Betim",
            id: "https://randomuser.me/api/portraits/men/3.jpg",
            nome: "Arnold Schwarzenegger",
            numero_pessoal: "4818",
            dataNasc: "01/05/1996",
            email: "bodybuilder@gmail.com",
            bio: "Bom dia estarei na academia o dia inteiro",
            categoria: "Engenharia Civil",
            nota: "84",
            telefone: "651-566-515",
            senha: "",
            logado: "0",
            cor: "1",
            carteirinha:"/img/Portrait_Placeholder.png",
            senhacanvas: "1234",
            admin:""

        },
        {

            cidade: "Santa Luzia",
            id: "https://randomuser.me/api/portraits/women/24.jpg",
            nome: "Larissa de Macedo Machado",
            numero_pessoal: "8462",
            dataNasc: "02/08/2005",
            email: "anitta_44@gmail.com",
            bio: "Talvez me conheça como Anitta",
            categoria: "Engenharia elétrica",
            nota: "21",
            telefone: "185-241-2568",
            senha: "",
            logado: "0",
            cor: "1",
            carteirinha:"/img/Portrait_Placeholder.png",
            senhacanvas: "1234",
            admin:""

        },
        {

            cidade: "Betim",
            id: "https://randomuser.me/api/portraits/women/19.jpg",
            nome: "Joana D'Ark",
            numero_pessoal: "5412",
            dataNasc: "01/03/1960",
            email: "joandarkness@gmail.com",
            bio: "Escutando evanescence",
            categoria: "Engenharia elétrica",
            nota: "75",
            telefone: "156-156-1525",
            senha: "",
            logado: "0",
            cor: "1",
            carteirinha:"/img/Portrait_Placeholder.png",
            senhacanvas: "1234",
            admin:""

        },
        {
            
            cidade: "Santa Luzia",
            id: "https://randomuser.me/api/portraits/men/1.jpg",
            nome: "Jhon Cena",
            numero_pessoal: "55485",
            dataNasc: "02/09/1999",
            email: "wwasmackdownvsraw@gmail.com",
            bio: "Binchiling",
            categoria: "Engenharia Civil",
            nota: "15",
            telefone: "485-256-7895",
            senha: "",
            logado: "0",
            cor: "1",
            carteirinha:"/img/Portrait_Placeholder.png",
            senhacanvas: "1234",
            admin:""
        },
        {

            cidade: "Contagem",
            id: "https://randomuser.me/api/portraits/women/1.jpg",
            nome: "Dona Wanda",
            numero_pessoal: "4557",
            dataNasc: "22/02/1956",
            email: "comocriaemail@gmail.com",
            bio: "Estou aprendendo ainda",
            categoria: "Engenharia elétrica",
            nota: "22",
            telefone: "152-152-1513",
            senha: "",
            logado: "0",
            cor: "1",
            carteirinha:"/img/Portrait_Placeholder.png",
            senhacanvas: "1234",
            admin:""

        },
        {
            
            cidade: "Ribeirão das Neves",
            id: "https://randomuser.me/api/portraits/men/22.jpg",
            nome: "João Getúlio",
            numero_pessoal: "12345",
            dataNasc: "06/07/1999",
            email: "exemplo1@gmail.com",
            bio: "Bom dia estou fazendo um arquivo json",
            categoria: "Análise e desenvolvimento de sistemas",
            nota: "63",
            telefone: "010-692-6593",
            senha: "",
            logado: "0",
            cor: "1",
            carteirinha:"/img/Portrait_Placeholder.png",
            senhacanvas: "1234",
            admin:""

        }, 
        
        {   
            cidade: "Ribeirão das Neves",
            id:"https://randomuser.me/api/portraits/women/17.jpg",
            nome: "Ana Palhares",
            numero_pessoal: "98765",
            dataNasc: "06/02/2000",
            email: "exemplo2@gmail.com",
            bio: "Bom dia sou ana palhares como vai você?",
            categoria: "Psicologia",
            nota: "52",
            telefone: "010-692-6593",
            senha: "",
            logado: "0",
            cor: "1",
            carteirinha:"/img/Portrait_Placeholder.png",
            senhacanvas: "1234",
            admin:""

        }, 
        
        {
            
            cidade: "Ribeirão das Neves",
            id: "https://randomuser.me/api/portraits/men/14.jpg",
            nome: "Dwaine Jhonson",
            numero_pessoal: "45678",
            dataNasc: "02/09/1997",
            email: "exemplo3@gmail.com",
            bio: "Bom dia sou conhecido como THE ROCK",
            categoria: "Direito",
            nota: "12",
            telefone: "010-692-6593",
            senha: "senhaforte123",
            logado: "0",
            cor: "1",
            carteirinha:"/img/Portrait_Placeholder.png",
            senhacanvas: "1234",
            admin:"1"
            
        }, 
        
        {
            
            cidade: "Ribeirão das Neves",
            id: "https://randomuser.me/api/portraits/men/10.jpg",
            nome: "Marcos",
            numero_pessoal: "78945",
            dataNasc: "07/04/1992",
            email: "exemplo5@gmail.com",
            bio: "Bom dia sou aquele cara",
            categoria: "Engenharia Civil",
            nota: "55",
            telefone: "010-692-6593",
            senha: "123",
            logado: "0",
            cor: "1",
            carteirinha:"/img/Portrait_Placeholder.png",
            senhacanvas: "1234",
            admin:""
        }, 
        
        {
            
            cidade: "Ribeirão das Neves",
            id: "https://randomuser.me/api/portraits/women/20.jpg",
            nome: "Antonia",
            numero_pessoal: "12378",
            dataNasc: "01/01/1990",
            email: "exemplo6@gmail.com",
            bio: "Boa noite eu durmo de dia",
            categoria: "Engenharia elétrica",
            nota: "25",
            telefone: "010-692-6593",
            senha: "",
            logado: "0",
            cor: "2",
            carteirinha:"/img/Portrait_Placeholder.png",
            senhacanvas: "1234",
            admin:""
        }
    ]
};

// Caso os dados já estejam no Local Storage, caso contrário, carrega os dados iniciais
var db = JSON.parse(localStorage.getItem('db_contato'));

if (!db) {
    db = db_contato
};

//NOME E FOTO NA BARRA DE PERFIL
for (let i = 0; i < db.data.length; i++) {
    if (db.data[i].logado == "1") {
        $("#nome").append(`${db.data[i].nome}`);
        document.getElementById('fotita').src=db.data[i].id
    }
}

//SELEÇÃO DO ESTILO
for (let i = 0; i < db.data.length; i++) {

    if (db.data[i].logado == "1") {
        if (db.data[i].cor == "1") {
            document.getElementById('cor').href = "style.css"
            break;
        }
        else if (db.data[i].cor == "2") {
            document.getElementById('cor').href = "style2.css"
            break;
        }
    }
}

function insertContato(contato) {

    let novoContato = {

        cidade: contato.cidade,
        id: contato.id,
        nome: contato.nome,
        numero_pessoal: contato.numero_pessoal,
        dataNasc: contato.dataNasc,
        email: contato.email,
        bio: contato.bio,
        categoria: contato.categoria,
        nota: contato.nota,
        telefone: contato.telefone,
        senha: contato.senha,
        logado: contato.logado,
        cor: "1",
        carteirinha:"/img/Portrait_Placeholder.png",
        senhacanvas: "1234",
        admin:""
        

    };

    // Insere o novo objeto no array
    db.data.push(novoContato);
    console.log("Contato inserido com sucesso");

    // Atualiza os dados no Local Storage
    localStorage.setItem('db_contato', JSON.stringify(db));
}

function updateContato(nome, contato) {
    // Localiza o indice do objeto a ser alterado no array a partir do seu nome

    let dados=db_contato.data;

    let index = 0;

    for(let i=0; i<dados.length ;i++){
        if (dados[i].nome==nome){
            index = i;
        }
    }

    // Altera os dados do objeto no array

    db.data[index].cidade = contato.cidade,
    db.data[index].id = contato.id,
    db.data[index].nome = contato.nome,
    db.data[index].numero_pessoal = contato.numero_pessoal,
    db.data[index].dataNasc = contato.dataNasc,
    db.data[index].email = contato.email,
    db.data[index].bio = contato.bio,
    db.data[index].categoria = contato.categoria,
    db.data[index].nota = contato.nota,
    db.data[index].telefone = contato.telefone;
    db.data[index].senha = contato.senha;
    db.data[index].logado = contato.logado;
    db.data[index].cor = contato.cor;
    db.data[index].carteirinha = contato.carteirinha;
    db.data[index].senhacanvas = contato.senhacanvas;
    db.data[index].admin = contato.admin;

    console.log("Contato alterado com sucesso");



    // Atualiza os dados no Local Storage
    localStorage.setItem('db_contato', JSON.stringify(db));
}

function deleteContato(numero_pessoal) {    
    // Filtra o array removendo o elemento com o numero_pessoal passado
    let index;
    let verificando;
    
    for (let i = 0; i < db.data.length; i++) {
        verificando = db.data[i];
        if (numero_pessoal == verificando.numero_pessoal) {
            index = i;
        }
    }
    
    db.data.splice(index,1)
    console.log("Contato removido com sucesso");

    // Atualiza os dados no Local Storage
    localStorage.setItem('db_contato', JSON.stringify(db));
}

function logout() {
    for (let i = 0; i < db.data.length; i++) {
        if (db.data[i].logado == "1") {

            let logou = "0";

            let contato = {
                cidade: db.data[i].cidade,
                id: db.data[i].id,
                nome: db.data[i].nome,
                numero_pessoal: db.data[i].numero_pessoal,
                dataNasc: db.data[i].dataNasc,
                email: db.data[i].email,
                bio: db.data[i].bio,
                categoria: db.data[i].categoria,
                nota: db.data[i].nota,
                telefone: db.data[i].telefone,
                senha: db.data[i].senha,
                logado: logou,
                cor:db.data[i].cor,
                carteirinha:db.data[i].carteirinha
            };

            updateContato(db.data[i].nome, contato);

        }

    }
}